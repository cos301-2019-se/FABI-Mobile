<!--Bootstrap Navbar-->
<div class="container-fluid" id="nav-section">
  <nav class="navbar navbar-expand-xl">
    <a class="navbar-brand" href="#">System Reports</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <i class="fas fa-bars"></i>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">

        <li class="nav-item active">
          <a id="dashboard_menu_link" routerLink="/admin-dashboard"><i class="fas fa-home"></i>Home</a>
        </li>

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-tasks"></i>Handlers
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a id="user_management" routerLink="/staff-handler"><i class="fas fa-id-card"></i>Staff</a>
            <br />
            <a id="organization_management" routerLink="/organization-handler"><i
                class="fas fa-building"></i>Organizations</a>
            <br />
            <a id="diagnostic_clinic_management" routerLink="/clinic-handler"><i
                class="fas fa-stethoscope"></i>Clinic</a>
            <br />
            <a id="database_management" routerLink="/database-handler"><i class="fas fa-database"></i>Database
            </a>
          </div>
        </li>

        <li class="nav-item">
          <a id="reporting" routerLink="/reporting"><i class="fas fa-chart-pie"></i>Reporting</a>
        </li>


        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-user"></i>Account
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdown">
            <a id="profile_menu_link" routerLink="/admin-profile"><i class="fas fa-user-circle"></i>Profile</a>
            <br />
            <a id="settings_menu_link" routerLink="/"><i class="fas fa-cogs"></i>Settings</a>
          </div>
        </li>

        <li class="nav-item">
          <a id="help_menu_link" routerLink="/"><i class="fas fa-question"></i>Help</a>
        </li>

        <li class="nav-item">
          <a id="logout_menu_link" (click)="logout()" style="color:#ffffff;"><i
              class="fas fa-sign-out-alt"></i>Logout</a>
        </li>

      </ul>
    </div>
  </nav>
</div>


<!--SlideOut -->
<div id="slideOut" [ngClass]="{'showSlideOut': toggle_status}">
  <!--Tab-->
  <div class="slideOutTab" (click)="toggleNotificaitonsTab()">
    <div>
      <p>Notifications</p>
    </div>
  </div>
  <div class="modal-content">
    <div class="modal-header">
      <h4 class="modal-title">Admin Notifications</h4>
    </div>
    <div class="modal-body" id="notifications-section">

      <h2 *ngIf="!notifications">No notifications</h2>
      <!--*********************************************************************
              DO THE SAME THING HERE AS WITH ADMIN AND STAFF WITH NGIF AND NGFOR
          *************************************************************************-->
      <div *ngIf="allNotifications">
        <div class="box" *ngFor="let log of allNotifications">
          <div class="notification-heading">
            <h2>Notification {{log.ID}}</h2>
            <i class="fas fa-times" (click)="removeNotification({{log.LogID}})"></i>
          </div>

          <div class="notification-content">
            <p><b>Type:</b> {{log.Type}} notification</p>
            <p><b>Action:</b> {{log.Action}}</p>
            <p><b>Date:</b> {{log.Date}}</p>
          </div>
        </div>
      </div>

    </div>
    <div class="modal-footer"> </div>
  </div>
</div>

<!--Organization Handler Content-->
<div class="container-fluid">

  <!--Database Handler Content-->
  <div class="content">
    <!-- <div class="color-accent">
        <h1>Database Management</h1>
      </div> -->

    <div class="system-reporting">
      <!--Tab Menu-->
      <mat-tab-group animationDuration="1000ms">

        <!--Reporting Tab Option-->
        <mat-tab>
          <ng-template mat-tab-label>
            <i class="fas fa-chart-pie" style="color:darkgray;padding:5px;"></i>
            Reporting
          </ng-template>

          <br/>
          <div class="tab-content" id="reports" ng-app="portApp" ngController="previewCtrl">
              <button class="btn btn-default" (click)="generateRequestReport()">Generate Request Report</button>
              <button class="btn btn-default" (click)="generateDepositReport()">Generate Deposit Report</button>
              <button class="btn btn-default" (click)="generateRevitalizationReport()">Generate Revitalization Report</button>
              <button class="btn btn-default" (click)="generateSampleSubmissionReport()">Generate Sample Submission Report</button>
              <button class="btn btn-default" (click)="generateErrorReport()">Generate Error Report</button>

              <br/><br/><br/><br/>
              <!-- <h3 *ngIf="!errorReport">There are currently no system errors</h3> -->
              <div id="errorReport" *ngIf='errorReport' #errorReportPDF>
                <h2 id="error_report">FABI System Error Report</h2>
                <p>Date: {{date}}</p>
                <br/><br/><br/>
                <table *ngIf="errorLogs" id="previewTableErrorLogs">
                  <thead>
                    <tr>
                      <th>Error status code</th>
                      <th>Date</th>
                      <th>Details of error</th>
                      <th>User performing action</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="tableRow" *ngFor="let row of errorLogsArray; let i = index">
                      <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                    </tr>
                  </tbody>
                </table>
                <br /><br />
                <div id="FABI_logo"><img src="../../assets/images/fabi-logo.png"><img src="../../assets/images/TPCP.jpg"></div>
                <br/><br/>
              </div>
              <button *ngIf='errorReport' (click)="downloadErrorReport()">Download Error Report</button>

              <input matInput type="date" placeholder="Date From" #requestDateFrom *ngIf='requestReport' (change)="setDateFrom()"/><input matInput type="date" placeholder="Date To" #requestDateTo *ngIf='requestReport' (change)="setDateTo()"/>
              <div id="requestReport" *ngIf='requestReport' #requestReportPDF>
                <h2 id="request_report">FABI System Request Report</h2>
                <p>Date: {{date}}</p>
                <br/><br/><br/>
                <table *ngIf="requestLogs" id="previewTableRequestLogs">
                  <thead>
                    <tr>
                      <th>Person</th>
                      <th>Requestor</th>
                      <th>CMW Culture Number</th>
                      <th>Taxon Name</th>
                      <th>Reference Number</th>
                      <th>Date Requested</th>
                      <th>Date Submitted</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="tableRow" *ngFor="let row of requestLogsArray; let i = index">
                      <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                    </tr>
                  </tbody>
                </table>
                <br /><br />
                <div id="FABI_logo"><img src="../../assets/images/fabi-logo.png"><img src="../../assets/images/TPCP.jpg"></div>
                <br/><br/>
              </div>
              <button *ngIf='requestReport' (click)="downloadRequestReport()">Download Request Report</button>

              <input matInput type="date" placeholder="Date From" #depositDateFrom *ngIf='depositReport' (change)="setDateFrom()"/><input matInput type="date" placeholder="Date To" #depositDateTo *ngIf='depositReport' (change)="setDateTo()"/>
              <div id="depositReport" *ngIf='depositReport' #depositReportPDF>
                <h2 id="deposit_report">FABI System Deposit Report</h2>
                <p>Date: {{date}}</p>
                <br/><br/><br/>
                <table *ngIf="depositLogs" id="previewTableDepositLogs">
                  <thead>
                    <tr>
                      <th>Person</th>
                      <th>CMW Culture Number</th>
                      <th>Culture Name</th>
                      <th>Collected By</th>
                      <th>Date Collected</th>
                      <th>Isolated By</th>
                      <th>Identified By</th>
                      <th>Date Submitted</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="tableRow" *ngFor="let row of depositLogsArray; let i = index">
                      <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                    </tr>
                  </tbody>
                </table>
                <br /><br />
                <div id="FABI_logo"><img src="../../assets/images/fabi-logo.png"><img src="../../assets/images/TPCP.jpg"></div>
                <br/><br/>
              </div>
              <button *ngIf='depositReport' (click)="downloadDepositReport()">Download Deposit Report</button> 
              
              <input matInput type="date" placeholder="Date From" #revitalizationDateFrom *ngIf='revitalizationReport' (change)="setDateFrom()"/><input matInput type="date" placeholder="Date To" #revitalizationDateTo *ngIf='revitalizationReport' (change)="setDateTo()"/>
              <div id="revitalizationReport" *ngIf='revitalizationReport' #revitalizationReportPDF>
                <h2 id="revitalization_report">FABI System Revitalization Report</h2>
                <p>Date: {{date}}</p>
                <br/><br/><br/>
                <table *ngIf="revitalizationLogs" id="previewTableRevitalizationLogs">
                  <thead>
                    <tr>
                      <th>Person</th>
                      <th>Requestor</th>
                      <th>CMW Culture Number</th>
                      <th>Culture Name</th>
                      <th>Reference Number</th>
                      <th>Date Requested</th>
                      <th>Date Returned</th>
                      <th>Date Submitted</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="tableRow" *ngFor="let row of revitalizationLogsArray; let i = index">
                      <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                    </tr>
                  </tbody>
                </table>
                <br /><br />
                <div id="FABI_logo"><img src="../../assets/images/fabi-logo.png"><img src="../../assets/images/TPCP.jpg"></div>
                <br/><br/>
              </div>
              <button *ngIf='revitalizationReport' (click)="downloadRevitalizationReport()">Download Revitalization Report</button>
          </div>
        </mat-tab>

        <!--Logs Tab Option-->
        <mat-tab>
          <ng-template mat-tab-label>
            <i class="fas fa-file" style="color:darkgray;padding:5px;"></i>
            Logs
          </ng-template>

          <div class="tab-content" id="logs" ng-app="portApp" ngController="previewCtrl">
            <h2>User Log Table</h2><div #userAdd (click)="expandUserLogTable()"><i class="fas fa-plus-circle"></i></div><div #userCollapse (click)="collapseUserLogTable()" id="userCollapse"><i class="fas fa-minus-circle"></i></div>
            <h3 *ngIf="!userLogs">There are currrently no user logs to display</h3>
            <br />

            <table *ngIf="userLogs" id="previewTableUserLogs" #userLogsTable>
              <thead>
                <tr>
                  <th>Action performed</th>
                  <th>Date</th>
                  <th>User performing action</th>
                  <th>Other users involved</th>
                </tr>
              </thead>
              <tbody>
                <tr class="tableRow" *ngFor="let row of userLogsArray; let i = index">
                  <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                </tr>
              </tbody>
            </table>
            <br /><br /><br />

            <h2>Database Management Log Table</h2><div #databaseAdd (click)="expandDatabaseLogTable()"><i class="fas fa-plus-circle"></i></div><div #databaseCollapse (click)="collapseDatabaseLogTable()" id="databaseCollapse"><i class="fas fa-minus-circle"></i></div>
            <h3 *ngIf="!databaseLogs">There are currrently no database management logs to display</h3>
            <br />

            <table *ngIf="databaseLogs" id="previewTableDatabaseLogs" #databaseLogsTable>
              <thead>
                <tr>
                  <th>Action performed</th>
                  <th>Date</th>
                  <th>User performing action</th>
                  <th>Database involved</th>
                </tr>
              </thead>
              <tbody>
                <tr class="tableRow" *ngFor="let row of databaseLogsArray; let i = index">
                  <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                </tr>
              </tbody>
            </table>
            <br /><br /><br />

            <h2>Access Log Table</h2><div #accessAdd (click)="expandAccessLogTable()"><i class="fas fa-plus-circle"></i></div><div #accessCollapse (click)="collapseAccessLogTable()" id="accessCollapse"><i class="fas fa-minus-circle"></i></div>
            <h3 *ngIf="!accessLogs">There are currrently no access logs to display</h3>
            <br />

            <table *ngIf="accessLogs" id="previewTableAccessLogs" #accessLogsTable>
              <thead>
                <tr>
                  <th>Details of access</th>
                  <th>Date</th>
                  <th>User performing action</th>
                  <th>More information(if any)</th>
                </tr>
              </thead>
              <tbody class="collapsible">
                <tr class="tableRow" *ngFor="let row of accessLogsArray; let i = index">
                  <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                </tr>
              </tbody>
            </table>
            <br /><br /><br />

            <h2>Error Log Table</h2><div #errorAdd (click)="expandErrorLogTable()"><i class="fas fa-plus-circle"></i></div><div #errorCollapse (click)="collapseErrorLogTable()" id="errorCollapse"><i class="fas fa-minus-circle"></i></div>
            <h3 *ngIf="!errorLogs">There are currrently no error logs to display</h3>
            <br />

            <table *ngIf="errorLogs" id="previewTableErrorLogs" #errorLogsTable>
              <thead>
                <tr>
                  <th>Error status code</th>
                  <th>Date</th>
                  <th>Details of error</th>
                  <th>User performing action</th>
                </tr>
              </thead>
              <tbody class="collapsible">
                <tr class="tableRow" *ngFor="let row of errorLogsArray; let i = index">
                  <th *ngFor="let key of row; let j = index">{{ row[j] }} </th>
                </tr>
              </tbody>
            </table>
            <br /><br /><br /><br />
          </div>
        </mat-tab>

      </mat-tab-group>
    </div>
  </div>



</div>